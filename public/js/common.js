$(document).ready(function(){function e(){setTimeout(function(){s.removeClass("fadeOut").addClass("animated fadeInUp")},1e3)}function t(){p.on("click",function(){$(".nav__menu-list").toggleClass("fadeInDown fadeOutUp"),f.prop("hidden")||f.hide(),r.prop("hidden")||r.hide(),u.each(function(e){$(this).removeClass("nav__menu-item-active")})}),d.on("click",function(){$(this).hasClass(".menu-active")&&r.hide(),f.prop("hidden")||f.hide(),r.slideToggle()}),l.on("click",function(){r.prop("hidden")||r.hide(),f.slideToggle()}),u.on("click",function(){u.each(function(e){$(this).removeClass("nav__menu-item-active")}),$(this).toggleClass("nav__menu-item-active")}),c.on("click",function(){f.prop("hidden")||f.hide(),r.prop("hidden")||r.hide()}),$(".nav__menu-item>a").addClass("nohover")}function o(){d.off(),l.off(),c.off(),h.off(),u.off(),r.off(),f.off(),p.off(),f.prop("hidden")||f.hide(),r.prop("hidden")||r.hide(),u.each(function(e){$(this).removeClass("nav__menu-item-active")})}function n(){$(m).fadeIn(600),$(".product__image-wrapper img, .product__image img, .products__wrapper img").addClass("animated").waypoint(function(e){if("down"===e){var t=$(this)[0].element;$(t).addClass("fadeInRight").css({opacity:"1"})}},{offset:"70%"});(new function(){this.didscroll=!0,this.lastScrollTop=0,this.delta=5,this.st=$(window).scrollTop(),this.navbarHeight=$("header").outerHeight();var e=this;this.init=function(){$(window).scroll(function(t){e.didscroll=!0}),setInterval(function(){e.didscroll&&(e.hasScrolled(),e.didscroll=!1,e.lastScrollTop=e.st)},250)},this.hasScrolled=function(){e.st=$(window).scrollTop(),Math.abs(e.st)<=e.delta&&$("header").removeClass("scrolledNav"),Math.abs(e.lastScrollTop-e.st)<=e.delta||(e.st>e.lastScrollTop&&e.st>e.navbarHeight?($("header").addClass("nav-up").removeClass("nav-down"),setTimeout(function(){$("header").addClass("scrolledNav")},800)):e.st+$(window).height()<$(document).height()&&$("header").removeClass("nav-up").addClass("nav-down"))}}).init();var e=new a(r,d,500),t=new a(f,l,500);e.init(),t.init(),$(".nav__menu-item>a").removeClass("nohover")}function a(e,t,o){this.submenu=e,this.item=t,this.time=300,this.timer=o||500;var n=this;this.showMenu=function(){$(n.submenu).is(":hover")&&(clearTimeout($.data(n.item,"timer")),$(n.submenu).one("mouseout",n.hideMenu)),$(n.submenu).stop().css({display:"block"}),$(n.submenu).one("mouseout",n.showMenu)},this.hideMenu=function(){$.data(n.item,"timer",setTimeout(function(){$(n.submenu).stop().css({display:"none"}),$(n.submenu).off()},n.timer))},this.init=function(){$(this.item).hover(n.showMenu,n.hideMenu)}}$("a[rel='m_PageScroll2id']").mPageScroll2id(),$("body").imagesLoaded(function(){var e=$("#page-preloader");e.find("spinner").fadeOut(),e.delay(1e3).fadeOut("slow")}).fail(function(e){var t=$("#page-preloader");t.find("spinner").fadeOut(),t.delay(1e3).fadeOut("slow"),console.log("_-_-",e)});if($(".anim-slider").find(".anim-slide").length>1)$(".anim-slider").animateSlider({autoplay:!0,interval:1e4,animations:{0:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"zoomIn",delayShow:"delay1s"},a:{show:"zoomIn",delayShow:"delay2s"}},1:{li:{show:"fadeIn",hide:"fadeOut"},figure:{show:"rollIn",hide:"fadeOut",delayShow:"delay1s"},h1:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2s"},p:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2-5s"},a:{show:"zoomIn",delayShow:"delay4s"}},2:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},a:{show:"zoomIn",delayShow:"delay3s"}},3:{li:{show:"fadeIn",hide:"fadeOut"},img:{show:"zoomIn",delayShow:"delay2-5s"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},a:{show:"fadeInLeftLarge",delayShow:"delay4s"}}}});else{e();var s=$(".content-wrapper *");console.log(s),s.waypoint(function(t){"down"===t?s.removeClass("fadeInUp").addClass("fadeOut").css("opacity","0"):e()},{offset:"20%"})}var d=$(".item-products"),l=$(".item-areause"),c=$(".nav__menu-item:nth-child(3)"),h=$(".nav__menu-item:last-child"),u=$(".nav__menu-item"),r=$(".nav__submenu-product"),f=$(".nav__submenu-ind"),m=$(".nav__menu-list"),p=$("button.tcon");window._ScWidth=document.documentElement.clientWidth,window._ScHeight=document.documentElement.clientHeight,window._ScWidth<751?(console.log("width=",window._ScWidth),t()):(console.log("width=",window._ScWidth),n()),window.onresize=function(){window._ScWidth=document.documentElement.clientWidth,window._ScWidth<751?(o(),console.log("mobile events width=",window._ScWidth),t()):(console.log("desktop events width=",window._ScWidth),o(),n())};var w=$(".btn");$(w).hover(function(){$(this).animate({backgroundColor:"#ececec"},200),$(this).addClass("animated pulse")},function(){$(this).animate({backgroundColor:"transparent"},200),$(this).removeClass("animated pulse").css({opacity:"1"})}),transformicons.add(".tcon"),$(".concept__image-wrapper").waypoint(function(e){"down"===e&&$(this.element).css({display:"block"})},{offset:"-90%"}),$.notify.addStyle("gray",{html:"<div><span data-notify-text/></div>",classes:{base:{"background-color":"#818181",padding:"10px 20px","border-radius":"5px",color:"white","font-size":"16px"}}}),$.notify.addStyle("foo",{html:"<div><div class='clearfix'><div class='title' data-notify-html='title'/><div class='buttons'><button class='no'>Отмена</button><button class='yes' data-notify-text='button'></button></div></div></div>"}),$(document).on("click",".notifyjs-foo-base .no",function(){$(this).trigger("notify-hide")}),$(document).on("click",".notifyjs-foo-base .yes",function(){v.clear(),$(this).trigger("notify-hide")});var v=new function(){this.mainButton=$(".nav__item-bag"),this.buyButton=$("[data-id]"),this.body=$(".cart_wrapper"),this.templateSchema=$("#entry-template").html();var e=this;a.apply(this,[e.body,e.mainButton,1e3]),this.init=function(){this.clickToBuy(),this.checkBage(),this.deleteItem(),$(this.mainButton).hover(this.showMenu,this.hideMenu)},this.innerEvents=function(){e.deleteItem(),e.clearButton(),e.recountButton(),e.showForm()},this.clickToBuy=function(){$(e.buyButton).on("click",function(){var t=$(this).attr("data-id"),o=this;$.ajax({url:"/add-to-cart/"+t,success:function(t,n){$("header").removeClass("nav-up").addClass("nav-down"),$(o).notify("Добавлено в корзину",{position:"bottom center",style:"gray",showAnimation:"fadeIn",arrowShow:!0}),e.template(t)}})})},this.template=function(t){var o=e.templateSchema,n=Handlebars.compile(o)(t);e.appendBody(n),t.totalQty<1&$(".bage").is(":visible")?$(".bage").fadeOut("slow"):$(".bage").fadeIn("slow"),$(".bage").html(t.totalQty),e.innerEvents()},this.checkBage=function(){$.ajax({url:"/stored-products/",success:function(t,o){""!=t&&$(".bage").fadeIn("slow"),$(".bage").html(t.totalQty),e.template(t),console.log(t.empty),console.log(t.totalQty)}})},this.appendBody=function(t){$(e.body).html(t)},this.deleteItem=function(){$(".product-delete").on("click",function(){var t=$(this).attr("data-id");console.log("id=",t),$.ajax({url:"/recount-cart/"+t,success:function(t,o){""==t&&$(".bage").fadeOut("slow").html(""),console.log(t),e.template(t),e.show()}})})},this.clearButton=function(){$(".cart-clear").on("click",function(){$(this).notify({title:"Вы хотите очистить корзину?",button:"Да"},{style:"foo",position:"bottom right",autoHide:!1,clickToHide:!1})})},this.clear=function(){$.ajax({url:"/clear-cart/",success:function(t,o){e.template(t),e.hide()}})},this.recountButton=function(){$(':input[type="number"]').one("change",function(e){$(".cart-refresh").fadeIn()}),$(".cart-refresh").on("click",function(){var t=$(".cart .cart__item"),o={};for(i=0;i<t.length;i++){var n=Number($(t[i]).find('[type="number"]').val());o[$(t[i]).find("[data-id]").attr("data-id")]=n}$.ajax({method:"POST",url:"/save-cart",data:o,success:function(t,o){e.template(t)}})})},this.showForm=function(){$(".send-order .fa").on("click",function(){$.ajax({url:"/show-form/",dataType:"html",success:function(e,t){var o=$.parseHTML(e);$(o).find(".fa-times").on("click",function(){$(this).parent().remove(),console.log("ok")}),$("body").append(o)}})})}};v.init()});