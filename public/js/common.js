$(document).ready(function(){function e(){setTimeout(function(){d.removeClass("fadeOut").addClass("animated fadeInUp")},1e3)}function t(){$(".nav__menu-list").addClass("fadeOutUp"),w.on("click",function(){$(".nav__menu-list").toggleClass("fadeInDown fadeOutUp"),m.prop("hidden")||m.hide(),f.prop("hidden")||f.hide(),r.each(function(e){$(this).removeClass("nav__menu-item-active")})}),l.on("click",function(){$(this).hasClass(".menu-active")&&f.hide(),m.prop("hidden")||m.hide(),f.slideToggle()}),c.on("click",function(){f.prop("hidden")||f.hide(),m.slideToggle()}),r.on("click",function(){r.each(function(e){$(this).removeClass("nav__menu-item-active")}),$(this).toggleClass("nav__menu-item-active")}),h.on("click",function(){m.prop("hidden")||m.hide(),f.prop("hidden")||f.hide()}),$(".nav__menu-item>a").addClass("nohover")}function n(){l.off(),c.off(),h.off(),u.off(),r.off(),f.off(),m.off(),w.off(),m.prop("hidden")||m.hide(),f.prop("hidden")||f.hide(),r.each(function(e){$(this).removeClass("nav__menu-item-active")})}function o(){$(p).fadeIn(600),$(".product__image-wrapper img, .product__image img, .products__wrapper img").addClass("animated").waypoint(function(e){if("down"===e){var t=$(this)[0].element;$(t).addClass("fadeInRight").css({opacity:"1"})}},{offset:"70%"});(new function(){this.didscroll=!0,this.lastScrollTop=0,this.delta=5,this.st=$(window).scrollTop(),this.navbarHeight=$("header").outerHeight();var e=this;this.init=function(){$(window).scroll(function(t){e.didscroll=!0}),setInterval(function(){e.didscroll&&(e.hasScrolled(),e.didscroll=!1,e.lastScrollTop=e.st)},250)},this.hasScrolled=function(){e.st=$(window).scrollTop(),Math.abs(e.st)<=e.delta&&$("header").removeClass("scrolledNav"),Math.abs(e.lastScrollTop-e.st)<=e.delta||(e.st>e.lastScrollTop&&e.st>e.navbarHeight?($("header").addClass("nav-up").removeClass("nav-down"),setTimeout(function(){$("header").addClass("scrolledNav")},800)):e.st+$(window).height()<$(document).height()&&$("header").removeClass("nav-up").addClass("nav-down"))}}).init();var e=new a(f,l,500),t=new a(m,c,500);e.init(),t.init(),$(".nav__menu-item>a").removeClass("nohover")}function a(e,t,n){this.submenu=e,this.item=t,this.time=300,this.timer=n||500;var o=this;this.showMenu=function(){$(o.submenu).is(":hover")&&(clearTimeout($.data(o.item,"timer")),$(o.submenu).one("mouseout",o.hideMenu)),$(o.submenu).stop().css({display:"block"}),$(o.submenu).one("mouseout",o.showMenu)},this.hideMenu=function(){$.data(o.item,"timer",setTimeout(function(){$(o.submenu).stop().css({display:"none"}),$(o.submenu).off()},o.timer))},this.init=function(){$(this.item).hover(o.showMenu,o.hideMenu)}}var s=$("[data-stars-lighted]");$(s).waypoint(function(e){var t=$(this)[0].element,n=$(t).attr("data-stars-lighted"),o=$(t).find("i"),i=0;if(0!=n)var a=setInterval(function(){$(o[i]).addClass("animated flipInX").animate({color:"#dd3333"},1e3),++i==n&&clearInterval(a)},200)},{offset:"70%"}),$("a[rel='m_PageScroll2id']").mPageScroll2id(),$("body").imagesLoaded(function(){var e=$("#page-preloader");e.find("spinner").fadeOut(),e.delay(1e3).fadeOut("slow")}).fail(function(e){var t=$("#page-preloader");t.find("spinner").fadeOut(),t.delay(1e3).fadeOut("slow"),console.log("_-_-",e)});if($(".anim-slider").find(".anim-slide").length>1)$(".anim-slider").animateSlider({autoplay:!0,interval:1e4,animations:{0:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"zoomIn",delayShow:"delay1s"},a:{show:"zoomIn",delayShow:"delay2s"}},1:{li:{show:"fadeIn",hide:"fadeOut"},figure:{show:"rollIn",hide:"fadeOut",delayShow:"delay1s"},h1:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2s"},p:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2-5s"},a:{show:"zoomIn",delayShow:"delay4s"}},2:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},a:{show:"zoomIn",delayShow:"delay3s"}},3:{li:{show:"fadeIn",hide:"fadeOut"},img:{show:"zoomIn",delayShow:"delay2-5s"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},a:{show:"fadeInLeftLarge",delayShow:"delay4s"}}}});else{e();var d=$(".content-wrapper *");console.log(d),d.waypoint(function(t){"down"===t?d.removeClass("fadeInUp").addClass("fadeOut").css("opacity","0"):e()},{offset:"20%"})}var l=$(".item-products"),c=$(".item-areause"),h=$(".nav__menu-item:nth-child(3)"),u=$(".nav__menu-item:last-child"),r=$(".nav__menu-item"),f=$(".nav__submenu-product"),m=$(".nav__submenu-ind"),p=$(".nav__menu-list"),w=$("button.tcon");window._ScWidth=document.documentElement.clientWidth,window._ScHeight=document.documentElement.clientHeight,window._ScWidth<751?(console.log("width=",window._ScWidth),t()):(console.log("width=",window._ScWidth),o()),window.onresize=function(){window._ScWidth=document.documentElement.clientWidth,window._ScWidth<751?(n(),console.log("mobile events width=",window._ScWidth),t()):(console.log("desktop events width=",window._ScWidth),n(),o())};var v=$(".btn");$(v).hover(function(){$(this).animate({backgroundColor:"#ececec"},200),$(this).addClass("animated pulse")},function(){$(this).animate({backgroundColor:"transparent"},200),$(this).removeClass("animated pulse").css({opacity:"1"})}),transformicons.add(".tcon"),$(".concept__image-wrapper").waypoint(function(e){"down"===e&&$(this.element).css({display:"block"})},{offset:"-90%"}),$.notify.addStyle("gray",{html:"<div><span data-notify-text/></div>",classes:{base:{"background-color":"#818181",padding:"10px 20px","border-radius":"5px",color:"white","font-size":"16px"}}}),$.notify.addStyle("foo",{html:"<div><div class='clearfix'><div class='title' data-notify-html='title'/><div class='buttons'><button class='no'>Отмена</button><button class='yes' data-notify-text='button'></button></div></div></div>"}),$(document).on("click",".notifyjs-foo-base .no",function(){$(this).trigger("notify-hide")}),$(document).on("click",".notifyjs-foo-base .yes",function(){y.clear(),$(this).trigger("notify-hide")});var y=new function(){this.mainButton=$(".nav__item-bag"),this.buyButton=$("[data-id]"),this.body=$(".cart_wrapper"),this.templateSchema=$("#entry-template").html();var e=this;a.apply(this,[e.body,e.mainButton,1e3]),this.init=function(){this.clickToBuy(),this.checkBage(),this.deleteItem(),$(this.mainButton).hover(this.showMenu,this.hideMenu)},this.innerEvents=function(){e.deleteItem(),e.clearButton(),e.recountButton(),e.showForm()},this.clickToBuy=function(){$(e.buyButton).on("click",function(){var t=$(this).attr("data-id"),n=this;$.ajax({url:"/add-to-cart/"+t,success:function(t,o){$("header").removeClass("nav-up").addClass("nav-down"),$(n).notify("Добавлено в корзину",{position:"bottom center",style:"gray",showAnimation:"fadeIn",arrowShow:!0}),e.template(t)}})})},this.template=function(t){var n=e.templateSchema,o=Handlebars.compile(n)(t);e.appendBody(o),t.totalQty<1&$(".bage").is(":visible")?$(".bage").fadeOut("slow"):$(".bage").fadeIn("slow"),$(".bage").html(t.totalQty),e.innerEvents()},this.checkBage=function(){$.ajax({url:"/stored-products/",success:function(t,n){""!=t&&$(".bage").fadeIn("slow"),$(".bage").html(t.totalQty),e.template(t),console.log(t.empty),console.log(t.totalQty)}})},this.appendBody=function(t){$(e.body).html(t)},this.deleteItem=function(){$(".product-delete").on("click",function(){var t=$(this).attr("data-id");console.log("id=",t),$.ajax({url:"/recount-cart/"+t,success:function(t,n){""==t&&$(".bage").fadeOut("slow").html(""),console.log(t),e.template(t),e.show()}})})},this.clearButton=function(){$(".cart-clear").on("click",function(){$(this).notify({title:"Вы хотите очистить корзину?",button:"Да"},{style:"foo",position:"bottom right",autoHide:!1,clickToHide:!1})})},this.clear=function(){$.ajax({url:"/clear-cart/",success:function(t,n){e.template(t),e.hide()}})},this.recountButton=function(){$(':input[type="number"]').one("change",function(e){$(".cart-refresh").fadeIn()}),$(".cart-refresh").on("click",function(){var t=$(".cart .cart__item"),n={};for(i=0;i<t.length;i++){var o=Number($(t[i]).find('[type="number"]').val());n[$(t[i]).find("[data-id]").attr("data-id")]=o}$.ajax({method:"POST",url:"/save-cart",data:n,success:function(t,n){e.template(t)}})})},this.showForm=function(){$(".send-order .fa").on("click",function(){$.ajax({url:"/show-form/",dataType:"html",success:function(e,t){var n=$.parseHTML(e);$(n).find(".fa-times").on("click",function(){$(this).parent().remove(),console.log("ok")}),$("body").append(n)}})})}};y.init()});