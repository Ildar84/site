$(document).ready(function(){function e(){setTimeout(function(){c.removeClass("fadeOut").addClass("animated fadeInUp")},1e3)}function t(){$(v).hide(),y.on("click",function(){$(".nav__menu-list").slideToggle(),w.prop("hidden")||w.hide(),p.prop("hidden")||p.hide(),m.each(function(e){$(this).removeClass("nav__menu-item-active")})}),h.on("click",function(){$(this).hasClass(".menu-active")&&p.hide(),w.prop("hidden")||w.hide(),p.slideToggle()}),f.on("click",function(){p.prop("hidden")||p.hide(),w.slideToggle()}),m.on("click",function(){m.each(function(e){$(this).removeClass("nav__menu-item-active")}),$(this).toggleClass("nav__menu-item-active")}),u.on("click",function(){w.prop("hidden")||w.hide(),p.prop("hidden")||p.hide()}),$(".nav__menu-item>a").addClass("nohover")}function o(){h.off(),f.off(),u.off(),r.off(),m.off(),p.off(),w.off(),y.off(),w.prop("hidden")||w.hide(),p.prop("hidden")||p.hide(),m.each(function(e){$(this).removeClass("nav__menu-item-active")})}function n(){function e(){$(p).is(":hover")&&(clearTimeout($.data(h,"timer")),$(p).one("mouseout",t)),$(p).stop().fadeIn(300),$(p).one("mouseover",e)}function t(){$.data(h,"timer",setTimeout(function(){$(p).stop().fadeOut(300),$(p).off(),console.log("hide")},500))}function o(){$(w).is(":hover")&&(clearTimeout($.data(f,"timer")),$(w).one("mouseout",n)),$(w).stop().fadeIn(300),$(w).one("mouseover",o)}function n(){$.data(f,"timer",setTimeout(function(){$(w).stop().fadeOut(300),$(w).off()},500))}$(v).fadeIn(600),$(h).hover(e,t),$(f).hover(o,n),$(".nav__menu-item>a").removeClass("nohover")}$("#slider3").stellar({horizontalScrolling:!1});var a,s=0,d=5,l=$("header").outerHeight();$(window).scroll(function(e){a=!0}),setInterval(function(){a&&(!function(){var e=$(this).scrollTop();Math.abs(e)<=d&&$("header").removeClass("scrolledNav"),Math.abs(s-e)<=d||(e>s&&e>l?($("header").removeClass("nav-down").addClass("nav-up"),setTimeout(function(){$("header").addClass("scrolledNav")},800)):e+$(window).height()<$(document).height()&&$("header").removeClass("nav-up").addClass("nav-down"),s=e)}(),a=!1)},250),$("body").imagesLoaded(function(){var e=$("#page-preloader");e.find("spinner").fadeOut(),e.delay(1e3).fadeOut("slow"),$("#slider4").stellar()}).fail(function(e){var t=$("#page-preloader");t.find("spinner").fadeOut(),t.delay(1e3).fadeOut("slow"),console.log("_-_-",e)});if($(".anim-slider").find(".anim-slide").length>1)$(".anim-slider").animateSlider({autoplay:!0,interval:1e4,animations:{0:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"zoomIn",delayShow:"delay1s"},button:{show:"zoomIn",delayShow:"delay2s"}},1:{li:{show:"fadeIn",hide:"fadeOut"},figure:{show:"rollIn",hide:"fadeOut",delayShow:"delay1s"},h1:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2s"},p:{show:"fadeInUp",hide:"fadeOut",delayShow:"delay2-5s"},button:{show:"zoomIn",delayShow:"delay4s"}},2:{li:{show:"fadeIn",hide:"fadeOut"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},button:{show:"zoomIn",delayShow:"delay3s"}},3:{li:{show:"fadeIn",hide:"fadeOut"},img:{show:"zoomIn",delayShow:"delay2-5s"},h1:{show:"fadeInUp",delayShow:"delay1s"},p:{show:"zoomIn",delayShow:"delay2s"},button:{show:"fadeInLeftLarge",delayShow:"delay4s"}}}});else{e();var c=$(".content-wrapper *");console.log(c),c.waypoint(function(t){"down"===t?c.removeClass("fadeInUp").addClass("fadeOut").css("opacity","0"):e()},{offset:"20%"})}var h=$(".nav__menu-item:first-child"),f=$(".nav__menu-item:nth-child(2)"),u=$(".nav__menu-item:nth-child(3)"),r=$(".nav__menu-item:last-child"),m=$(".nav__menu-item"),p=$(".nav__submenu-product"),w=$(".nav__submenu-ind"),v=$(".nav__menu-list"),y=$("button.tcon");window._ScWidth=document.documentElement.clientWidth,window._ScHeight=document.documentElement.clientHeight,window._ScWidth<751?(console.log("width=",window._ScWidth),t()):(console.log("width=",window._ScWidth),n()),window.onresize=function(){window._ScWidth=document.documentElement.clientWidth,window._ScWidth<751?(o(),console.log("mobile events width=",window._ScWidth),t()):(console.log("desktop events width=",window._ScWidth),o(),n())};var g=$(".btn");$(g).hover(function(){$(this).animate({backgroundColor:"#ececec"},200),$(this).addClass("animated pulse")},function(){$(this).animate({backgroundColor:"transparent"},200),$(this).removeClass("animated pulse").css({opacity:"1"})}),$(".content-wrapper").swipe({swipe:function(e,t,o,n,i,a){console.log(i)},threshold:30}),transformicons.add(".tcon"),$(".concept__image-wrapper").waypoint(function(e){"down"===e&&$(this.element).css({display:"block"})},{offset:"-90%"}),$(".products__wrapper img").waypoint(function(e){"down"===e&&$(this.element).addClass("animated fadeInRight").css({display:"block"})},{offset:"60%"}),$.notify.addStyle("gray",{html:"<div><span data-notify-text/></div>",classes:{base:{"background-color":"#818181",padding:"10px 20px","border-radius":"5px",color:"white","font-size":"16px"}}}),$.notify.addStyle("foo",{html:"<div><div class='clearfix'><div class='title' data-notify-html='title'/><div class='buttons'><button class='no'>Отмена</button><button class='yes' data-notify-text='button'></button></div></div></div>"}),$(document).on("click",".notifyjs-foo-base .no",function(){$(this).trigger("notify-hide")}),$(document).on("click",".notifyjs-foo-base .yes",function(){b.clear(),$(this).trigger("notify-hide")});var b=new function(){this.mainButton=$(".fa-shopping-bag"),this.buyButton=$(".purchase .btn"),this.body=$(".cart_wrapper"),this.templateSchema=$("#entry-template").html(),self=this,this.init=function(){this.clickToBuy(),this.checkBage(),this.deleteItem(),$(this.mainButton).hover(this.show,this.hide)},this.innerEvents=function(){self.deleteItem(),self.clearButton(),self.recountButton(),self.showForm()},this.show=function(){$(self.body).is(":hover")&&(console.log("hovered"),clearTimeout($.data(self.mainButton,"timer")),$(self.body).one("mouseout",self.hide)),$(self.body).stop().css({display:"block"}),$(self.body).one("mouseover",self.show)},this.hide=function(){$.data(self.mainButton,"timer",setTimeout(function(){$(self.body).stop().slideUp(),$(self.body).off()},1e3))},this.clickToBuy=function(){$(".purchase .btn").on("click",function(){var e=$(this).attr("data-id"),t=this;$.ajax({url:"/add-to-cart/"+e,success:function(e,o){$("header").removeClass("nav-up").addClass("nav-down"),$(t).notify("Добавлено в корзину",{position:"right top",style:"gray",showAnimation:"fadeIn",arrowShow:!0}),self.template(e)}})})},this.template=function(e){var t=self.templateSchema,o=Handlebars.compile(t)(e);self.appendBody(o),e.totalQty<1&$(".bage").is(":visible")?$(".bage").fadeOut("slow"):$(".bage").fadeIn("slow"),$(".bage").html(e.totalQty),self.innerEvents()},this.checkBage=function(){$.ajax({url:"/stored-products/",success:function(e,t){""!=e&&$(".bage").fadeIn("slow"),$(".bage").html(e.totalQty),self.template(e),console.log(e.empty),console.log(e.totalQty)}})},this.appendBody=function(e){$(self.body).html(e)},this.deleteItem=function(){$(".product-delete").on("click",function(){var e=$(this).attr("data-id");console.log("id=",e),$.ajax({url:"/recount-cart/"+e,success:function(e,t){""==e&&$(".bage").fadeOut("slow").html(""),console.log(e),self.template(e),self.show()}})})},this.clearButton=function(){$(".cart-clear").on("click",function(){$(this).notify({title:"Вы хотите очистить корзину?",button:"Да"},{style:"foo",position:"bottom right",autoHide:!1,clickToHide:!1})})},this.clear=function(){$.ajax({url:"/clear-cart/",success:function(e,t){self.template(e),self.hide()}})},this.recountButton=function(){$(':input[type="number"]').one("change",function(e){$(".fa-refresh").fadeIn()}),$(".cart-refresh").on("click",function(){var e=$(".cart .cart__item"),t={};for(i=0;i<e.length;i++){var o=Number($(e[i]).find('[type="number"]').val());t[$(e[i]).find("[data-id]").attr("data-id")]=o}$.ajax({method:"POST",url:"/save-cart",data:t,success:function(e,t){self.template(e)}})})},this.showForm=function(){$(".send-order .fa").on("click",function(){$.ajax({url:"/show-form/",dataType:"html",success:function(e,t){var o=$.parseHTML(e);$(o).find(".fa-times").on("click",function(){$(this).parent().remove(),console.log("ok")}),$("body").append(o)}})})}};b.init()});